scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0) +
xlim(0,30) +
ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
xlim(0,30) +
ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
# xlim(0,30) +
# ylim(0,30) +
# xlim(0,30) +
# ylim(0,30) +
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 26, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 27, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 26.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -4, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 26.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 26.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
p_plot_rm
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4)
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
p_plot_rm
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
p_plot_rm
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
p_plot_rm
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 26.5, y = 15.75, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.75, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
p_plot_rm
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
p_plot_rm
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
View(lm_ls_h2_prune)
View(lm_ls_h2_prune)
View(lm_ls_h2)
View(lm_ls_h2_prune)
ww_ls_h2_plot <- ggplot(ww_ls_h2_full) +
geom_point(aes(x = trait, y = H2), size = 3) +
geom_errorbar(aes(ymin=ci_l, ymax=ci_r, x = trait), colour="black", width=0.05) +
labs(x = "", y = "Heritability") +
ylim(0, 1) +
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ww_hs_h2_plot <- ggplot(ww_ls_h2_full) +
geom_point(aes(x = trait, y = H2), size = 3) +
geom_errorbar(aes(ymin=ci_l, ymax=ci_r, x = trait), colour="black", width=0.05) +
labs(x = "", y = "Heritability") +
ylim(0, 1) +
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ww_hs_h2_plot
ww_ls_h2_plot
ww_hs_h2_plot <- ggplot(ww_hs_h2_full) +
geom_point(aes(x = trait, y = H2), size = 3) +
geom_errorbar(aes(ymin=ci_l, ymax=ci_r, x = trait), colour="black", width=0.05) +
labs(x = "", y = "Heritability") +
ylim(0, 1) +
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ww_ls_h2_full <- bind_rows(ww_hs_h2, ww_hs_h2_outliers_removed) %>%
dplyr::mutate(trait = as.factor(c("WW_HS","WW_HS no outliers")))
ww_hs_h2_plot <- ggplot(ww_hs_h2_full) +
geom_point(aes(x = trait, y = H2), size = 3) +
geom_errorbar(aes(ymin=ci_l, ymax=ci_r, x = trait), colour="black", width=0.05) +
labs(x = "", y = "Heritability") +
ylim(0, 1) +
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ww_ls_h2_full <- bind_rows(ww_hs_h2, ww_hs_h2_outliers_removed) %>%
dplyr::mutate(trait = as.factor(c("WW_HS","WW_HS no outliers")))
ww_hs_h2_full <- bind_rows(ww_hs_h2, ww_hs_h2_outliers_removed) %>%
dplyr::mutate(trait = as.factor(c("WW_HS","WW_HS no outliers")))
ww_ls_h2_full <- bind_rows(ww_ls_h2, ww_ls_h2_outliers_removed) %>%
dplyr::mutate(trait = as.factor(c("WW_LS","WW_LS no outliers")))
ww_hs_h2_full <- bind_rows(ww_hs_h2, ww_hs_h2_outliers_removed) %>%
dplyr::mutate(trait = as.factor(c("WW_HS","WW_HS no outliers")))
ww_ls_h2_plot <- ggplot(ww_ls_h2_full) +
geom_point(aes(x = trait, y = H2), size = 3) +
geom_errorbar(aes(ymin=ci_l, ymax=ci_r, x = trait), colour="black", width=0.05) +
labs(x = "", y = "Heritability") +
ylim(0, 1) +
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ww_hs_h2_plot <- ggplot(ww_hs_h2_full) +
geom_point(aes(x = trait, y = H2), size = 3) +
geom_errorbar(aes(ymin=ci_l, ymax=ci_r, x = trait), colour="black", width=0.05) +
labs(x = "", y = "Heritability") +
ylim(0, 1) +
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
View(ww_hs_h2_full)
View(ww_ls_h2_full)
lm_corr <- lm_df_proc %>%
dplyr::filter(strain %in% names(strain.colours)) %>%
dplyr::distinct(strain, strain_median) %>%
dplyr::rename(median_ls = strain_median) %>%
dplyr::ungroup() %>%
dplyr::mutate(strain = factor(strain, levels = median_ls_order_lm)) %>%
dplyr::mutate(ls_rank = seq(1, 12, 1)) %>%
stats::setNames (paste0('lm_', names(.)))
ww_scorr <- ww_df_proc %>%
dplyr::filter(trait == "ls") %>%
dplyr::distinct(strain, median_ls) %>%
dplyr::arrange(median_ls) %>%
dplyr::ungroup() %>%
dplyr::mutate(strain = factor(strain, levels = median_ls_order)) %>%
dplyr::mutate(ls_rank = seq(1, 12, 1)) %>%
stats::setNames (paste0('ww_', names(.))) %>%
dplyr::mutate(ww_strain = factor(ww_strain, levels = median_ls_order_lm)) %>%
dplyr::arrange(ww_strain)
ww_pcorr <- ww_scorr %>%
dplyr::mutate(ww_strain = factor(ww_strain, levels = median_ls_order_lm)) %>%
dplyr::arrange(ww_strain)
pcorr_df <- cbind(lm_corr, ww_pcorr)
scorr_df <- cbind(lm_corr, ww_scorr)
pcorr_df_prune <- pcorr_df %>% dplyr::filter(lm_strain != "CX11314")
scorr_df_prune <- scorr_df %>% dplyr::filter(lm_strain != "CX11314")
stest <- cor.test(x = scorr_df$lm_ls_rank, y = scorr_df$ww_ls_rank)
ptest <- cor.test(x = pcorr_df$lm_median_ls, y = pcorr_df$ww_median_ls)
stest_prune <- cor.test(x = scorr_df_prune$lm_ls_rank, y = scorr_df_prune$ww_ls_rank)
ptest_prune <- cor.test(x = pcorr_df_prune$lm_median_ls, y = pcorr_df_prune$ww_median_ls)
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = -6, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
xlim(14,30) +
ylim(14,30) +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
#geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
xlim(14,30) +
ylim(14,30) +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
#geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
p_plot <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(method = 'lm', se = FALSE, color = "black", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
xlim(14,30) +
ylim(14,30) +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
#geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest[4]), digits = 3)), size = 3, color = "black") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest[4]), digits = 3)), size = 3, color = "black")
p_plot_rm <- ggplot(pcorr_df, aes(x = lm_median_ls, y = ww_median_ls)) +
stat_smooth(data = pcorr_df %>% dplyr::filter(lm_strain != "CX11314"), aes(x = lm_median_ls, y = ww_median_ls), method = 'lm', se = FALSE, color = "red", size = 0.5) +
geom_point(aes(x = lm_median_ls, y = ww_median_ls, fill = lm_strain), shape = 21, size = 3) +
geom_point(aes(x = 29.60182, y = 17.10, color = "red"), shape = 4, size = 4) +
scale_fill_manual(values = strain.colours) +
labs(x="Lifespan LM", y="Lifespan WW") +
theme_bw() +
xlim(14,30) +
ylim(14,30) +
theme(legend.position = "none") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
# xlim(0,30) +
# ylim(0,30) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
#geom_text(x = 27.5, y = 15.25, label = paste0("r = ", round(as.numeric(ptest_prune[4]), digits = 3)), size = 3, color = "red") +
geom_text(x = 25.5, y = 15.25, label = paste0("ρ =", round(as.numeric(stest_prune[4]), digits = 3)), size = 3, color = "red")
full_corr <- cowplot::plot_grid(p_plot, p_plot_rm, ncol = 2, align = "vh", labels = c("A", "B"))
full_corr
