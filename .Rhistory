d$D <- abs(rnorm(n, sd=4))
d[1, 4:7] <- d[1, 4:7] * 3
head(d)
full_world_plot + geom_scatterpie(aes(x=long, y=lat, group=region, r=radius),
data=d, cols=LETTERS[1:4], color=NA, alpha=.8) +
geom_scatterpie_legend(d$radius, x=-160, y=-55)
world <- map_data('world')
p <- ggplot(world, aes(long, lat)) +
geom_map(map=world, aes(map_id=region), fill=NA, color="black") +
coord_quickmap()
p + geom_scatterpie(aes(x=long, y=lat, group=region, r=radius),
data=d, cols=LETTERS[1:4], color=NA, alpha=.8) +
geom_scatterpie_legend(d$radius, x=-160, y=-55)
p
p + geom_scatterpie(aes(x=long, y=lat, group=region, r=radius),
data=d, cols=LETTERS[1:4], color=NA, alpha=.8) +
geom_scatterpie_legend(d$radius, x=-160, y=-55)
View(d)
ggplot() + geom_scatterpie(aes(x=long, y=lat, group=region), data=d,
cols=LETTERS[1:4]) + coord_equal()
d$radius <- 6 * abs(rnorm(n))
p <- ggplot() + geom_scatterpie(aes(x=long, y=lat, group=region, r=radius), data=d,
cols=LETTERS[1:4], color=NA) + coord_equal()
p + geom_scatterpie_legend(d$radius, x=-140, y=-70)
world <- map_data('world')
p <- ggplot(world, aes(long, lat)) +
geom_map(map=world, aes(map_id=region), fill=NA, color="black") +
coord_quickmap()
p + geom_scatterpie(aes(x=long, y=lat, group=region, r=radius),
data=d, cols=LETTERS[1:4], color=NA, alpha=.8) +
geom_scatterpie_legend(d$radius, x=-160, y=-55)
full_world_plot + geom_scatterpie(aes(x=long, y=lat, group=region),
data=d, cols=LETTERS[1:4], color=NA, alpha=.8) +
geom_scatterpie_legend(d$radius, x=-160, y=-55)
full_world_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_point(aes(long, lat, fill = pop_assignment),
#            data=full_isolation_info %>%
#              dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
#                                                                              "J", "L", "B", "C", "E", "K"))) %>%
#              dplyr::arrange(pop_assignment),
#            shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()
full_world_plot
full_world_plot + geom_scatterpie(aes(x=long, y=lat, group=region),
data=full_isolation_info, cols=LETTERS[1:11], color=NA, alpha=.8)
full_world_plot + geom_scatterpie(aes(x=long, y=lat),
data=full_isolation_info, cols=LETTERS[1:11], color=NA, alpha=.8)
world <- map_data("world")
world <- world[world$region != "Antarctica",] # intercourse antarctica
full_isolation_info <- df %>%
#dplyr::filter(reference_strain == 1) %>%
dplyr::select(isotype, long = longitude, lat = latitude, state, country) %>%
dplyr::filter(lat != "None") %>%
dplyr::left_join(.,admix,by="isotype") %>%
dplyr::distinct(isotype, long, lat, .keep_all = TRUE) %>%
dplyr::filter(!is.na(pop_assignment))
full_world_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_point(aes(long, lat, fill = pop_assignment),
#            data=full_isolation_info %>%
#              dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
#                                                                              "J", "L", "B", "C", "E", "K"))) %>%
#              dplyr::arrange(pop_assignment),
#            shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()
full_world_plot + geom_scatterpie(aes(x=long, y=lat),
data=full_isolation_info, cols=LETTERS[1:11], color=NA, alpha=.8)
HW_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
theme(legend.position = "none")+
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(isolation_info, state == "Hawaii"), cols=LETTERS[1:11], color=NA, alpha=.8)
View(isolation_info)
View(full_isolation_info)
HW_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
theme(legend.position = "none")+
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii"), cols=LETTERS[1:11], color=NA, alpha=.8)
HW_plot + geom_repel(geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii"), cols=LETTERS[1:11], color=NA, alpha=.8))
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii"), cols=LETTERS[1:11],  alpha=.8)
unique(isotype_non_hi_admix_order$isotype)
list(unique(isotype_non_hi_admix_order$isotype))
test <- as.list(unique(isotype_non_hi_admix_order$isotype))
test
View(isotype_admix_order)
View(isotype_non_hi_admix_order)
View(k_full_hz)
k_full_hz_test <- k_full_hz %>%
dplyr::select(isotype, non_hi_admix_frac)
View(k_full_hz_test)
k_full_hz_test <- k_full_hz %>%
dplyr::select(isotype, non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all = T)
View(k_full_hz_test)
k_full_hz_test <- k_full_hz %>%
dplyr::select(isotype, non_hi_admix_frac)
View(k_full_hz_test)
View(k_full)
View(k_full)
k_full_hz_test <- k_full %>%
dplyr::select(isotype, non_hi_admix_frac)
k_full_hz_test <- k_full %>%
dplyr::select(isotype, non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all = T)
write.csv(k_full_hz_test, file = "/Users/tim/Desktop/admix_across_ks_frac.csv")
View(isotype_admix_order)
k_full_hz_test <- k_full %>%
dplyr::select(isotype, non_hi_admix_frac)
View(k_full_hz_test)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac)
View(isotype_non_hi_admix_order)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac) %>%
dplyr::mutate(total_nonHW_admix_frac = strain_sum_non_hi_admix_frac/9)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(strain_sum_non_hi_admix_frac))
View(isotype_non_hi_admix_order)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(strain_sum_non_hi_admix_frac)) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(strain_sum_non_hi_admix_frac)) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac, average_nonHW_admix_frac)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(strain_sum_non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac, average_nonHW_admix_frac)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac, average_nonHW_admix_frac)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(non_hi_admix_frac))
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, strain_sum_non_hi_admix_frac, average_nonHW_admix_frac)
isotype_non_hi_admix_order <- k_full %>%
dplyr::group_by(isotype) %>%
dplyr::mutate(strain_sum_non_hi_admix_frac = sum(non_hi_admix_frac)) %>%
dplyr::mutate(average_nonHW_admix_frac = mean(non_hi_admix_frac)) %>%
dplyr::ungroup() %>%
dplyr::arrange(strain_sum_non_hi_admix_frac) %>%
dplyr::distinct(isotype, .keep_all=T) %>%
dplyr::select(isotype, average_nonHW_admix_frac)
write.csv(isotype_non_hi_admix_order, file = "/Users/tim/Desktop/admix_across_ks_frac.csv")
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii" & isotype %in% c("XZ1515", "ECA372", "ECA738")), cols=LETTERS[1:11],  alpha=.8)
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii" & isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")), cols=LETTERS[1:11],  alpha=.8)
HW_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
geom_point(aes(long, lat, label = strain, fill = cluster),
data=dplyr::filter(isolation_info, state == "Hawaii" & !(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))),
fontface = 'bold', color = 'white',
segment.color = 'cyan')+
theme(legend.position = "none")+
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
View(isolation_info)
HW_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
geom_point(aes(long, lat, label = strain, fill = cluster),
data=dplyr::filter(isolation_info, state == "Hawaii" & !(strain %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))),
fontface = 'bold', color = 'white',
segment.color = 'cyan')+
theme(legend.position = "none")+
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii" & isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")), cols=LETTERS[1:11],  alpha=.8)
HW_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none")+
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii" & isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")), cols=LETTERS[1:11],  alpha=.8)
HW_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none")+
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii" & isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")), cols=LETTERS[1:11],  alpha=.8)
View(full_isolation_info)
View(full_isolation_info)
HW_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "Hawaii" & isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")), cols=LETTERS[1:11],  alpha=.8)
CAL_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap(xlim = c(-160,-155), ylim = c(19,22.3))  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "California" & isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")), cols=LETTERS[1:11],  alpha=.8)
CAL_plot
CAL_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "California" & isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710")), cols=LETTERS[1:11],  alpha=.8)
CAL_plot
View(full_isolation_info)
HW_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "California"), cols=LETTERS[1:11],  alpha=.8)
CAL_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "California"), cols=LETTERS[1:11],  alpha=.8)
CAL_plot + geom_scatterpie(aes(x=long, y=lat),
data=dplyr::filter(full_isolation_info, state == "California"), cols=LETTERS[1:11],  alpha=.8)
CAL_plot
west_coast <- states %>%
filter(region %in% c("california", "oregon", "washington"))
ggplot(data = west_coast)
states <- map_data("state")
west_coast <- states %>%
filter(region %in% c("california", "oregon", "washington"))
CAL_plot <- ggplot()+ geom_map(data=west_coast,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
, map=world,
CAL_plot <- ggplot()+ geom_map(data=west_coast, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
CAL_plot
geom_polygon(aes(x = long, y = lat, group = group), fill = "palegreen", color = "black") +
coord_quickmap()
ggplot(data = west_coast) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "palegreen", color = "black") +
coord_quickmap()
CAL_plot <- ggplot()+ geom_map(data=west_coast, map=states,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
CAL_plot
CAL_plot <- ggplot()+ geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
CAL_plot
View(west_coast)
states <- map_data("state")
states <- states %>%
filter(region %in% c("california", "oregon", "washington"))   # intercourse other states
CAL_plot <- ggplot()+ geom_map(data=states, map=states,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(!(isotype %in% c("XZ1515", "ECA372", "ECA738", "ECA189", "XZ1513", "QX1794", "ECA710"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
CAL_plot
CAL_plot <- ggplot()+ geom_map(data=states, map=states,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(state %in% c("california", "oregon", "washington"))) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
CAL_plot <- ggplot()+ geom_map(data=states, map=states,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(state %in% c("california", "oregon", "washington")) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
CAL_plot
CAL_plot <- ggplot()+ geom_map(data=states, map=states,
aes(x=long, y=lat, map_id=region),
color="black", fill="#E6E6E6", size=0.25)+
scale_fill_manual(values = ancestry.colours,name = "Population")+
theme_map()+
# geom_label_repel(aes(long, lat, label = strain, fill = cluster),
#                  data=dplyr::filter(isolation_info, state == "Hawaii"),
#                  fontface = 'bold', color = 'white',
#                  segment.color = 'cyan')+
geom_point(aes(long, lat, fill = pop_assignment),
data=full_isolation_info %>% dplyr::filter(state %in% c("California", "Oregon", "Washington")) %>%
dplyr::mutate(pop_assignment = factor(pop_assignment, level = c("A", "D", "F", "G", "H", "I",
"J", "B", "C", "E", "K"))) %>%
dplyr::arrange(pop_assignment),
shape = 21, size = 3) +
theme(legend.position = "none") +
coord_quickmap()  # coord_quickmap keeps correct aspect ratio
CAL_plot
View(full_isolation_info)
k11_popC <- full_isolation_info %>%
dplyr::filter(state %in% c("california", "oregon", "washington") & C>0.5)
